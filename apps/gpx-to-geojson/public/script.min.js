!function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require
if(!a&&u)return u(s,!0)
if(o)return o(s,!0)
var c=new Error("Cannot find module '"+s+"'")
throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}}
t[s][0].call(l.exports,function(e){var n=t[s][1][e]
return r(n?n:e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s])
return r}({1:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number")
return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,o,u,c
if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t
throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1
if(r(n))switch(arguments.length){case 1:n.call(this)
break
case 2:n.call(this,arguments[1])
break
case 3:n.call(this,arguments[1],arguments[2])
break
default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(s(n))for(o=Array.prototype.slice.call(arguments,1),c=n.slice(),i=c.length,u=0;i>u;u++)c[u].apply(this,o)
return!0},i.prototype.addListener=function(e,t){var n
if(!r(t))throw TypeError("listener must be a function")
return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function")
var i=!1
return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,o,a
if(!r(t))throw TypeError("listener must be a function")
if(!this._events||!this._events[e])return this
if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t)
else if(s(n)){for(a=o;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a
break}if(0>i)return this
1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n
if(!this._events)return this
if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this
if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t)
return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n)
else if(n)for(;n.length;)this.removeListener(e,n[n.length-1])
return delete this._events[e],this},i.prototype.listeners=function(e){var t
return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e]
if(r(t))return 1
if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,n){function i(){r("converter",function(e){o("converter",e,function(){i()})})}var r=e("../../components/drop-zone-gpx/index"),o=e("../../components/convert-gpx/index")
window.onload=function(){i()}},{"../../components/convert-gpx/index":3,"../../components/drop-zone-gpx/index":9}],3:[function(e,t,n){var i=e("./lib/html"),r=e("./lib/ctrl"),o=e("events").EventEmitter
t.exports=function(e,t,n){var s=new o
i.init(e,function(){r(e,t,s)}),s.on("gpx-converted",function(){n()})}},{"./lib/ctrl":6,"./lib/html":7,events:1}],4:[function(e,t,n){function i(){return{type:"Feature",properties:{},geometry:{}}}function r(e,t){var n=e,i=t,r=i-n
r/=1e3
var s=Math.floor(r%60)
r/=60
var a=Math.floor(r%60)
r/=60
var u=Math.floor(r%24),c=Math.floor(r/24)
if(0!==c)var l=c+" d "
else var l=""
return l+o(u)+"h "+o(a)+"m "+o(s)+"s"}function o(e){return 10>e?"0"+e:e}t.exports=function(e,t){var n=i(),o=[],s=0,a=0,u=null,c=null
e.forEach(function(t,n){0===n&&t.time&&(u=t.time),n===e.length-1&&t.time&&(c=t.time),0===n&&t.ele&&(s=t.ele),0!==n&&t.ele&&t.ele>s&&(a+=Math.floor(t.ele-s),s=t.ele),o.push([t.lon,t.lat])}),0!==a&&(n.properties.climb=a),u&&c&&(n.properties.time=r(u,c)),n.geometry={type:"LineString",coordinates:o},t({type:"FeatureCollection",features:[n]})}},{}],5:[function(e,t,n){function i(){return{type:"Feature",properties:{},geometry:{}}}t.exports=function(e,t){var n=[]
e.forEach(function(e,t){var r=i()
e.ele&&(r.properties.ele=e.ele),e.time&&(r.properties.time=e.time),r.geometry={type:"Point",coordinates:[e.lon,e.lat]},n.push(r)}),t({type:"FeatureCollection",features:n})}},{}],6:[function(e,t,n){var i=e("./html"),r=e("./msg"),o=e("./convert-to-points"),s=e("./convert-to-line"),a=e("../../utils/save")
t.exports=function(e,t,n){var u=document.getElementById("gpx-to-gj-points"),c=document.getElementById("gpx-to-gj-line")
document.getElementById("gpx-to-gj-line-simpl")
u.onclick=function(){i.process(e,function(){r.write("Converting..."),o(t,function(e){r.write("Saving..."),a.json("gpx-points.json",e),n.emit("gpx-converted")})})},c.onclick=function(){i.process(e,function(){r.write("Converting..."),s(t,function(e){r.write("Saving..."),a.json("gpx-line.json",e),n.emit("gpx-converted")})})}}},{"../../utils/save":17,"./convert-to-line":4,"./convert-to-points":5,"./html":7,"./msg":8}],7:[function(e,t,n){n.init=function(e,t){var n=document.getElementById(e)
n.innerHTML='<h2>Save as...</h2><button id="gpx-to-gj-points">Points</button><button id="gpx-to-gj-line">Line</button><p><b>Points</b> converts to a GeoJSON collection with all the points<br/><b>Line</b> converts to a GeoJSON collection with one "LineString" feature<br/>If you want to show a ride/run on a map, "Line" is what you want.</p>',t()},n.process=function(e,t){var n=document.getElementById(e)
n.innerHTML='<p id="gpx-msg"></p>',t()}},{}],8:[function(e,t,n){n.write=function(e){var t=document.getElementById("gpx-msg")
t.innerHTML=e},n.add=function(e){var t=document.getElementById("gpx-msg"),n=t.innerHTML
t.innerHTML=n+"</br>"+e}},{}],9:[function(e,t,n){var i=e("./lib/html"),r=e("./lib/init"),o=e("./lib/browse"),s=e("events").EventEmitter
t.exports=function(e,t){var n=new s
i.init(e,function(){r(n)
var t=document.getElementById("browse-btn")
t.onclick=function(){i.browse(e,function(){o(n)})}}),n.on("gpx-parsed",function(e){t(e)})}},{"./lib/browse":10,"./lib/html":11,"./lib/init":12,events:1}],10:[function(e,t,n){var i=(e("./msg"),e("./verify-dropped"))
t.exports=function(e){var t=document.getElementById("file-input")
t.onchange=function(n){i(t.files[0],e)}}},{"./msg":13,"./verify-dropped":16}],11:[function(e,t,n){n.init=function(e,t){var n=document.getElementById(e)
n.innerHTML='<div id="drop-zone"></div><p id="msg"></p><button id="browse-btn">Browse the file system</button>',t()},n.browse=function(e,t){var n=document.getElementById(e)
n.innerHTML='<p id="msg">Load a GPX file</p><input id="file-input" type="file"></input>',t()}},{}],12:[function(e,t,n){function i(e,t){e.preventDefault(),s(e.dataTransfer.files[0],t)}function r(e){e.ondragover=function(e){return e.preventDefault(),!1},e.ondragenter=function(e){return e.preventDefault(),!1}}var o=e("./msg"),s=e("./verify-dropped")
t.exports=function(e){if(window.FileReader){var t=document.getElementById("drop-zone")
r(t),t.ondrop=function(t){i(t,e)},o.write("Drop a GPX file"),o.add("or")}else o.write("Your browser does not support the HTML5 FileReader.")}},{"./msg":13,"./verify-dropped":16}],13:[function(e,t,n){n.write=function(e){var t=document.getElementById("msg")
t.innerHTML=e},n.add=function(e){var t=document.getElementById("msg"),n=t.innerHTML
t.innerHTML=n+"<br/>"+e}},{}],14:[function(e,t,n){function r(e,t){u(0,e.children,[],function(e){t(e)})}function o(e,t){c(0,e.children,[],function(e){t(e)})}function s(e,t){l(0,e.children,[],function(e){t(e)})}function a(e,t){var n={},r=e.attributes
for(i=0;i<r.length;i++)"lat"===r[i].name&&(n.lat=+r[i].value),"lon"===r[i].name&&(n.lon=+r[i].value)
var o=e.children
for(j=0;j<o.length;j++)if("ele"===o[j].nodeName&&(n.ele=+o[j].textContent),"time"===o[j].nodeName){var s=new Date(o[j].textContent)
n.time=Date.parse(s)}t(n.lat&&n.lon?n:null)}function u(e,t,n,i){e===t.length?i(n):"trk"===t[e].tagName?o(t[e],function(r){r.forEach(function(e){n.push(e)}),u(e+1,t,n,i)}):u(e+1,t,n,i)}function c(e,t,n,i){e===t.length?i(n):"trkseg"===t[e].tagName?s(t[e],function(r){r.forEach(function(e){n.push(e)}),c(e+1,t,n,i)}):c(e+1,t,n,i)}function l(e,t,n,i){e===t.length?i(n):"trkpt"===t[e].tagName?a(t[e],function(r){r&&n.push(r),Math.floor(e/1e3)===e/1e3?setTimeout(function(){f.write("Parsed "+e+" of "+t.length+" points"),l(e+1,t,n,i)},1):l(e+1,t,n,i)}):l(e+1,t,n,i)}var f=e("./msg")
t.exports=function(e,t){var n=e.children[0]
"gpx"!==n.nodeName?t("Not a valid GPX file"):r(n,function(e){f.write("Done parsing"),t(null,e)})}},{"./msg":13}],15:[function(e,t,n){function i(e,t){if(window.DOMParser){var n=new window.DOMParser
t(null,n.parseFromString(e,"text/xml"))}else t('Your browser does not support "DOMParser"')}t.exports=function(e,t){var n=new FileReader
n.onload=function(){i(n.result,function(e,n){t(e,n)})},n.readAsText(e)}},{}],16:[function(e,t,n){function i(e){return"application/gpx+xml"===e.type||"application/gpx"===e.type?(r.write("Document is a GPX file"),!0):(r.write("Document is not a GPX file"),!1)}var r=e("./msg"),o=e("./read-xml"),s=e("./parse-gpx")
t.exports=function(e,t){r.write("Verifying document..."),i(e)&&o(e,function(e,n){e?r.write(e):s(n,function(e,n){e?r.write(e):t.emit("gpx-parsed",n)})})}},{"./msg":13,"./parse-gpx":14,"./read-xml":15}],17:[function(e,t,n){var i=i||function(e){"use strict"
if(!("undefined"==typeof e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in i,o=function(e){var t=new MouseEvent("click")
e.dispatchEvent(t)},s=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c="application/octet-stream",l=4e4,f=function(e){var t=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}
setTimeout(t,l)},p=function(e,t,n){t=[].concat(t)
for(var i=t.length;i--;){var r=e["on"+t[i]]
if("function"==typeof r)try{r.call(e,n||e)}catch(o){u(o)}}},v=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,u,l){l||(t=v(t))
var d,m=this,h=t.type,g=h===c,y=function(){p(m,"writestart progress write writeend".split(" "))},w=function(){if((a||g&&s)&&e.FileReader){var i=new FileReader
return i.onloadend=function(){var t=a?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;"),n=e.open(t,"_blank")
n||(e.location.href=t),t=void 0,m.readyState=m.DONE,y()},i.readAsDataURL(t),void(m.readyState=m.INIT)}if(d||(d=n().createObjectURL(t)),g)e.location.href=d
else{var r=e.open(d,"_blank")
r||(e.location.href=d)}m.readyState=m.DONE,y(),f(d)}
return m.readyState=m.INIT,r?(d=n().createObjectURL(t),void setTimeout(function(){i.href=d,i.download=u,o(i),y(),f(d),m.readyState=m.DONE})):void w()},m=d.prototype,h=function(e,t,n){return new d(e,t||e.name||"download",n)}
return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=v(e)),navigator.msSaveOrOpenBlob(e,t)}:(m.abort=function(){},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,h)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content)
"undefined"!=typeof t&&t.exports?t.exports.saveAs=i:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return i}),n.json=function(e,t){var n=new Blob([JSON.stringify(t)],{type:"application/json;charset=utf-8"})
i(n,e)}},{}]},{},[2])
