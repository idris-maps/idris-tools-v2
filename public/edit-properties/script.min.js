!function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require
if(!a&&u)return u(s,!0)
if(o)return o(s,!0)
var c=new Error("Cannot find module '"+s+"'")
throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}}
t[s][0].call(f.exports,function(e){var n=t[s][1][e]
return r(n?n:e)},f,f.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s])
return r}({1:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number")
return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,o,u,c
if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t
throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1
if(r(n))switch(arguments.length){case 1:n.call(this)
break
case 2:n.call(this,arguments[1])
break
case 3:n.call(this,arguments[1],arguments[2])
break
default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(s(n))for(o=Array.prototype.slice.call(arguments,1),c=n.slice(),i=c.length,u=0;i>u;u++)c[u].apply(this,o)
return!0},i.prototype.addListener=function(e,t){var n
if(!r(t))throw TypeError("listener must be a function")
return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function")
var i=!1
return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,o,a
if(!r(t))throw TypeError("listener must be a function")
if(!this._events||!this._events[e])return this
if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t)
else if(s(n)){for(a=o;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a
break}if(0>i)return this
1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n
if(!this._events)return this
if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this
if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t)
return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n)
else if(n)for(;n.length;)this.removeListener(e,n[n.length-1])
return delete this._events[e],this},i.prototype.listeners=function(e){var t
return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e]
if(r(t))return 1
if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,n){function i(e){console.log("main",e),s("edit",e,function(t){"rm"===t?a("edit",e.data,function(t){r(e,t)}):"add-csv"===t&&u("edit",e.data,function(t){r(e,t)})})}function r(e,t){t&&(e.data=t),e.modif=!0,i(e)}var o=e("../../components/drop-zone-geojson-simple"),s=e("../../components/edit-main"),a=e("../../components/edit-properties-remove"),u=e("../../components/edit-properties-add-csv"),c=e("events").EventEmitter
window.onload=function(){var e={}
e.evt=new c,o("edit",function(t){e.data=t,i(e)})}},{"../../components/drop-zone-geojson-simple":10,"../../components/edit-main":19,"../../components/edit-properties-add-csv":22,"../../components/edit-properties-remove":27,events:1}],3:[function(e,t,n){var i=e("./lib/html"),r=e("./lib/init"),o=e("./lib/browse"),s=e("events").EventEmitter
t.exports=function(e,t){var n=new s
i.init(e,function(){r(n)
var t=document.getElementById("browse-btn")
t.onclick=function(){i.browse(e,function(){o(n)})}}),n.on("read-csv",function(e){t(e)})}},{"./lib/browse":4,"./lib/html":5,"./lib/init":6,events:1}],4:[function(e,t,n){var i=(e("./msg"),e("./verify-dropped"))
t.exports=function(e){var t=document.getElementById("file-input")
t.onchange=function(n){i(t.files[0],e)}}},{"./msg":7,"./verify-dropped":9}],5:[function(e,t,n){n.init=function(e,t){var n=document.getElementById(e)
n.innerHTML='<div id="drop-zone"></div><p id="msg"></p><button id="browse-btn">Browse the file system</button>',t()},n.browse=function(e,t){var n=document.getElementById(e)
n.innerHTML='<p id="msg">Load a CSV or TSV file</p><input id="file-input" type="file"></input>',t()}},{}],6:[function(e,t,n){function i(e,t){e.preventDefault(),s(e.dataTransfer.files[0],t)}function r(e){e.ondragover=function(e){return e.preventDefault(),!1},e.ondragenter=function(e){return e.preventDefault(),!1}}var o=e("./msg"),s=e("./verify-dropped")
t.exports=function(e){if(window.FileReader){var t=document.getElementById("drop-zone")
r(t),t.ondrop=function(t){i(t,e)},o.write("Drop a CSV file"),o.add("or")}else o.write("Your browser does not support the HTML5 FileReader.")}},{"./msg":7,"./verify-dropped":9}],7:[function(e,t,n){n.write=function(e){var t=document.getElementById("msg")
t.innerHTML=e},n.add=function(e){var t=document.getElementById("msg"),n=t.innerHTML
t.innerHTML=n+"<br/>"+e}},{}],8:[function(e,t,n){t.exports=function(e,t){var n=new FileReader
n.onload=function(){t(n.result)},n.readAsText(e)}},{}],9:[function(e,t,n){function i(e){return"text/csv"===e.type?(r.write("Document is a CSV file"),!0):"text/tab-separated-values"===e.type?(r.write("Document is a TSV file"),!0):(r.write("Document is not a CSV or TSV file"),!1)}var r=e("./msg"),o=e("./read-text")
t.exports=function(e,t){r.write("Verifying document..."),i(e)&&o(e,function(e){t.emit("read-csv",e)})}},{"./msg":7,"./read-text":8}],10:[function(e,t,n){var i=e("./lib/html"),r=e("./lib/init"),o=e("./lib/browse"),s=e("events").EventEmitter
t.exports=function(e,t){var n=new s
i.init(e,function(){r(n)
var t=document.getElementById("browse-btn")
t.onclick=function(){i.browse(e,function(){o(n)})}}),n.on("geojson-parsed",function(e){t(e)})}},{"./lib/browse":11,"./lib/html":12,"./lib/init":13,events:1}],11:[function(e,t,n){arguments[4][4][0].apply(n,arguments)},{"./msg":14,"./verify-dropped":17,dup:4}],12:[function(e,t,n){n.init=function(e,t){var n=document.getElementById(e)
n.innerHTML='<div id="drop-zone"></div><p id="msg"></p><button id="browse-btn">Browse the file system</button>',t()},n.browse=function(e,t){var n=document.getElementById(e)
n.innerHTML='<p id="msg">Load a GeoJSON file</p><input id="file-input" type="file"></input>',t()}},{}],13:[function(e,t,n){function i(e,t){e.preventDefault(),s(e.dataTransfer.files[0],t)}function r(e){e.ondragover=function(e){return e.preventDefault(),!1},e.ondragenter=function(e){return e.preventDefault(),!1}}var o=e("./msg"),s=e("./verify-dropped")
t.exports=function(e){if(window.FileReader){var t=document.getElementById("drop-zone")
r(t),t.ondrop=function(t){i(t,e)},o.write("Drop a GeoJSON file"),o.add("or")}else o.write("Your browser does not support the HTML5 FileReader.")}},{"./msg":14,"./verify-dropped":17}],14:[function(e,t,n){arguments[4][7][0].apply(n,arguments)},{dup:7}],15:[function(e,t,n){t.exports=function(e,t){var n=new FileReader
n.onload=function(){t(JSON.parse(n.result))},n.readAsText(e)}},{}],16:[function(e,t,n){var i=e("geojson-validation")
t.exports=function(e,t){"FeatureCollection"!==e.type?t(!1,["The file is not a GeoJSON FeatureCollection"]):i.valid(e,function(e,n){t(e,n)})}},{"geojson-validation":18}],17:[function(e,t,n){function i(e){var t=e.name.split("."),n=""
return t.forEach(function(e,i){i<t.length-1&&(n=0===i?e:n+"-"+e)}),n}function r(e,t){u(e,function(e,n){e?(s.write("Document is a valid GeoJSON"),t(!0)):(s.add("Document is not a valid GeoJSON"),s.add("Errors: "),n.forEach(function(e){"String"!=typeof e&&(e=e.toString()),s.add(e)}),t(!1))})}function o(e){return"application/json"===e.type?(s.write("Document is a JSON file"),s.add("Verifying if it is a valid GeoJSON file..."),!0):(s.write("Document is not a JSON file"),!1)}var s=e("./msg"),a=e("./read-json"),u=e("./validate-geojson")
t.exports=function(e,t){s.write("Verifying document..."),o(e)&&a(e,function(n){r(n,function(r){if(r){i(e)
t.emit("geojson-parsed",n)}})})}},{"./msg":14,"./read-json":15,"./validate-geojson":16}],18:[function(e,t,n){!function(e){function t(e){return"function"==typeof e}function n(e){return e===Object(e)}function i(e,n){var i=!1
return"string"==typeof n?n=[n]:"[object Array]"===Object.prototype.toString.call(n)?0===n.length&&(i=!0):i=!0,t(e)&&(i?e(i,[]):e(i,n)),i}function r(e,n){var i
if(t(s[e])){try{i=s[e](n)}catch(r){i=["Problem with custom definition for '"+e+": "+r]}if("string"==typeof result&&(i=[i]),"[object Array]"===Object.prototype.toString.call(i))return i}return[]}function o(t,n){var r=[]
return Array.isArray(t)?(t.forEach(function(t,n){e.isPosition(t,function(e,t){e||(t[0]="at "+n+": ".concat(t[0]),r=r.concat(t))})}),t[0].toString()!==t[t.length-1].toString()&&r.push("The first and last positions must be equivalent"),t.length<4&&r.push("coordinates must have at least four positions")):r.push("coordinates must be an array"),i(n,r)}var s={}
e.define=function(e,n){return e in c&&t(n)?(s[e]=n,!0):!1},e.isPosition=function(e,t){var n=[]
return Array.isArray(e)?e.length<=1&&n.push("Position must be at least two elements"):n.push("Position must be an array"),n=n.concat(r("Position",e)),i(t,n)},e.isGeoJSONObject=e.valid=function(e,t){if(!n(e))return i(t,["must be a JSON Object"])
var o=[]
if("type"in e){if(a[e.type])return a[e.type](e,t)
if(u[e.type])return u[e.type](e,t)
o.push('type must be one of: "Point", "MultiPoint", "LineString", "MultiLineString", "Polygon", "MultiPolygon", "GeometryCollection", "Feature", or "FeatureCollection"')}else o.push("must have a member with the name 'type'")
return o=o.concat(r("GeoJSONObject",e)),i(t,o)},e.isGeometryObject=function(e,t){if(!n(e))return i(t,["must be a JSON Object"])
var o=[]
if("type"in e){if(u[e.type])return u[e.type](e,t)
o.push('type must be one of: "Point", "MultiPoint", "LineString", "MultiLineString", "Polygon", "MultiPolygon" or "GeometryCollection"')}else o.push("must have a member with the name 'type'")
return o=o.concat(r("GeometryObject",e)),i(t,o)},e.isPoint=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"Point"!==t.type&&s.push("type must be 'Point'"):s.push("must have a member with the name 'type'"),"coordinates"in t?e.isPosition(t.coordinates,function(e,t){e||s.push("Coordinates must be a single position")}):s.push("must have a member with the name 'coordinates'"),s=s.concat(r("Point",t)),i(o,s)},e.isMultiPointCoor=function(t,n){var r=[]
return Array.isArray(t)?t.forEach(function(t,n){e.isPosition(t,function(e,t){e||(t[0]="at "+n+": ".concat(t[0]),r=r.concat(t))})}):r.push("coordinates must be an array"),i(n,r)},e.isMultiPoint=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"MultiPoint"!==t.type&&s.push("type must be 'MultiPoint'"):s.push("must have a member with the name 'type'"),"coordinates"in t?e.isMultiPointCoor(t.coordinates,function(e,t){e||(s=s.concat(t))}):s.push("must have a member with the name 'coordinates'"),s=s.concat(r("MultiPoint",t)),i(o,s)},e.isLineStringCoor=function(t,n){var r=[]
return Array.isArray(t)?t.length>1?t.forEach(function(t,n){e.isPosition(t,function(e,t){e||(t[0]="at "+n+": ".concat(t[0]),r=r.concat(t))})}):r.push("coordinates must have at least two elements"):r.push("coordinates must be an array"),i(n,r)},e.isLineString=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"LineString"!==t.type&&s.push("type must be 'LineString'"):s.push("must have a member with the name 'type'"),"coordinates"in t?e.isLineStringCoor(t.coordinates,function(e,t){e||(s=s.concat(t))}):s.push("must have a member with the name 'coordinates'"),s=s.concat(r("LineString",t)),i(o,s)},e.isMultiLineStringCoor=function(t,n){var r=[]
Array.isArray(t)?t.forEach(function(t,n){e.isLineStringCoor(t,function(e,t){e||(t[0]="at "+n+": ".concat(t[0]),r=r.concat(t))})}):r.push("coordinates must be an array"),i(n,r)},e.isMultiLineString=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"MultiLineString"!==t.type&&s.push("type must be 'MultiLineString'"):s.push("must have a member with the name 'type'"),"coordinates"in t?e.isMultiLineStringCoor(t.coordinates,function(e,t){e||(s=s.concat(t))}):s.push("must have a member with the name 'coordinates'"),s=s.concat(r("MultiPoint",t)),i(o,s)},e.isPolygonCoor=function(e,t){var n=[]
return Array.isArray(e)?e.forEach(function(e,t){o(e,function(e,i){e||(i[0]="at "+t+": ".concat(i[0]),n=n.concat(i))})}):n.push("coordinates must be an array"),i(t,n)},e.isPolygon=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"Polygon"!==t.type&&s.push("type must be 'Polygon'"):s.push("must have a member with the name 'type'"),"coordinates"in t?e.isPolygonCoor(t.coordinates,function(e,t){e||(s=s.concat(t))}):s.push("must have a member with the name 'coordinates'"),s=s.concat(r("Polygon",t)),i(o,s)},e.isMultiPolygonCoor=function(t,n){var r=[]
Array.isArray(t)?t.forEach(function(t,n){e.isPolygonCoor(t,function(e,t){e||(t[0]="at "+n+": ".concat(t[0]),r=r.concat(t))})}):r.push("coordinates must be an array"),i(n,r)},e.isMultiPolygon=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"MultiPolygon"!==t.type&&s.push("type must be 'MultiPolygon'"):s.push("must have a member with the name 'type'"),"coordinates"in t?e.isMultiPolygonCoor(t.coordinates,function(e,t){e||(s=s.concat(t))}):s.push("must have a member with the name 'coordinates'"),s=s.concat(r("MultiPolygon",t)),i(o,s)},e.isGeometryCollection=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"GeometryCollection"!==t.type&&s.push("type must be 'GeometryCollection'"):s.push("must have a member with the name 'type'"),"geometries"in t?Array.isArray(t.geometries)?t.geometries.forEach(function(t,n){e.isGeometryObject(t,function(e,t){e||(t[0]="at "+n+": ".concat(t[0]),s=s.concat(t))})}):s.push("'geometries' must be an array"):s.push("must have a member with the name 'geometries'"),s=s.concat(r("GeometryCollection",t)),i(o,s)},e.isFeature=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"Feature"!==t.type&&s.push("type must be 'feature'"):s.push("must have a member with the name 'type'"),"properties"in t||s.push("must have a member with the name 'properties'"),"geometry"in t?null!==t.geometry&&e.isGeometryObject(t.geometry,function(e,t){e||(s=s.concat(t))}):s.push("must have a member with the name 'geometry'"),s=s.concat(r("Feature",t)),i(o,s)},e.isFeatureCollection=function(t,o){if(!n(t))return i(o,["must be a JSON Object"])
var s=[]
return"bbox"in t&&e.isBbox(t.bbox,function(e,t){e||(s=s.concat(t))}),"type"in t?"FeatureCollection"!==t.type&&s.push("type must be 'FeatureCollection'"):s.push("must have a member with the name 'type'"),"features"in t?Array.isArray(t.features)?t.features.forEach(function(t,n){e.isFeature(t,function(e,t){e||(t[0]="at "+n+": ".concat(t[0]),s=s.concat(t))})}):s.push("'features' must be an array"):s.push("must have a member with the name 'features'"),s=s.concat(r("FeatureCollection",t)),i(o,s)},e.isBbox=function(e,t){var n=[]
Array.isArray(e)?e.length%2!==0&&n.push("bbox, must be a 2*n array"):n.push("bbox must be an array"),n=n.concat(r("Bbox",e)),i(t,n)}
var a={Feature:e.isFeature,FeatureCollection:e.isFeatureCollection},u={Point:e.isPoint,MultiPoint:e.isMultiPoint,LineString:e.isLineString,MultiLineString:e.isMultiLineString,Polygon:e.isPolygon,MultiPolygon:e.isMultiPolygon,GeometryCollection:e.isGeometryCollection},c={Feature:e.isFeature,FeatureCollection:e.isFeatureCollection,Point:e.isPoint,MultiPoint:e.isMultiPoint,LineString:e.isLineString,MultiLineString:e.isMultiLineString,Polygon:e.isPolygon,MultiPolygon:e.isMultiPolygon,GeometryCollection:e.isGeometryCollection,Bbox:e.isBox,Position:e.isPosition,GeoJSON:e.isGeoJSONObject,GeometryObject:e.isGeometryObject}
e.all_types=c}("undefined"==typeof n?this.GJV={}:n)},{}],19:[function(e,t,n){var i=e("./lib/html"),r=e("./lib/ctrl")
t.exports=function(e,t,n){i.init(e,t,function(){r.init(function(e){n(e)})})}},{"./lib/ctrl":20,"./lib/html":21}],20:[function(e,t,n){n.init=function(e){document.getElementById("add-csv").onclick=function(){e("add-csv")},document.getElementById("rm").onclick=function(){e("rm")}}},{}],21:[function(e,t,n){n.init=function(e,t,n){var i=""
t.modif&&(i+='<p class="small">Continue with edited collection</p>'),i+='<button id="add-csv">Add from CSV</button><button id="rm">Remove properties</button>',document.getElementById(e).innerHTML=i,n()}},{}],22:[function(e,t,n){var i=e("../utils/geo"),r=e("./lib/html"),o=e("./lib/ctrl"),s=e("./lib/parse"),a=e("events").EventEmitter,u=e("../drop-zone-csv"),c=e("./lib/utils"),f=e("../utils/save")
t.exports=function(e,t,n){var l=new a,h={}
h.feats=t.features,h.geoProps=i.getAllProperties(t.features),u(e,function(t){r.parsing(e,function(){s(t,function(e){c.checkParsed(l,e)})})}),l.on("parse-errors",function(t){r.parseErrors(e,t)}),l.on("parse-success",function(t){h.csv=t,r.header(e,t[0],function(){o.header(l)})}),l.on("is-not-head",function(){r.setHead(e,h.csv[0],function(){o.setHead(l,h.csv[0].length)})}),l.on("is-head",function(){l.emit("got-header",h.csv[0],!0)}),l.on("got-header",function(t,n){h.head=t,n&&h.csv.splice(0,1),h.csvJson=c.csvToJson(h.head,h.csv),r.joinProps(e,h.geoProps,h.head,function(){o.joinProps(l)})}),l.on("join-props",function(t,n){h.joinProps={geo:t,csv:n},r.joining(e,function(){c.joinThem(l,h.feats,h.csvJson,h.joinProps)})}),l.on("joined",function(t){h.joined=t,r.done(e,function(){o.done(l)})}),l.on("save",function(){f.json("edited.json",h.joined),n(null)}),l.on("continue",function(){n(h.joined)})}},{"../drop-zone-csv":3,"../utils/geo":31,"../utils/save":36,"./lib/ctrl":23,"./lib/html":24,"./lib/parse":25,"./lib/utils":26,events:1}],23:[function(e,t,n){n.header=function(e){var t=document.getElementById("csv-header-yes"),n=document.getElementById("csv-header-no")
t.onclick=function(){e.emit("is-head")},n.onclick=function(){e.emit("is-not-head")}},n.setHead=function(e,t){var n=[]
for(i=0;i<t;i++)n.push("set-head-input-"+i)
var r=[]
n.forEach(function(e){var t=document.getElementById(e)
r.push(t)})
var o=document.getElementById("set-head-done")
o.onclick=function(){var n=[]
r.forEach(function(e,t){var i=e.value
i&&n.push(i)}),n.length===t?e.emit("got-header",n,!1):document.getElementById("set-head-error").innerHTML="All column names need to be filled"}},n.joinProps=function(e){document.getElementById("join-btn").onclick=function(){var t=document.getElementById("geo-props").value,n=document.getElementById("csv-props").value
e.emit("join-props",t,n)}},n.done=function(e){document.getElementById("save").onclick=function(){e.emit("save")},document.getElementById("continue").onclick=function(){e.emit("continue")}}},{}],24:[function(e,t,n){n.parsing=function(e,t){document.getElementById(e).innerHTML="<p>Parsing...</p>",t()},n.parseErrors=function(e,t){var n="<p>Could not parse file.<br/><b>Errors</b>:<br/>"
t.forEach(function(e){var t=JSON.stringify(e)
n=n+t+"</br>"}),n+="</p>",document.getElementById(e).innerHTML=n},n.header=function(e,t,n){var i="<p>This is the first line:</p>"
t.forEach(function(e,t){i=i+'<p class="fake-table-cell">'+e+"</p>"}),i+='<p>Are these the names of the columns?</p><button id="csv-header-yes">Yes</button><button id="csv-header-no">No</button>',document.getElementById(e).innerHTML=i,n()},n.setHead=function(e,t,n){var i="<p>Name the columns</p><table><tr><th>First row</th><th>Column name</th></tr>"
t.forEach(function(e,t){i=i+"<tr><td>"+e+'</td><td><input id="set-head-input-'+t+'"></td></tr><p id="set-head-error"></p>'}),i+='</table><button id="set-head-done">Done</button>',document.getElementById(e).innerHTML=i,n()},n.joinProps=function(e,t,n,i){var r='<p>Properties to use for join</p><p><b>In the GeoJSON file</b></p><select id="geo-props">'
t.forEach(function(e){r=r+'<option value="'+e+'">'+e+"</option>"}),r+='</select><p><b>In the CSV file</b></p><select id="csv-props">',n.forEach(function(e){r=r+'<option value="'+e+'">'+e+"</option>"}),r+='</select><button id="join-btn">OK</button>',document.getElementById(e).innerHTML=r,i()},n.joining=function(e,t){var n="<p><b>Joining...</b></p>"
document.getElementById(e).innerHTML=n,t()},n.done=function(e,t){var n='<p><b>Properties have been added</b></p><button id="save">Save collection</button><button id="continue">Continue editing</button>'
document.getElementById(e).innerHTML=n,t()}},{}],25:[function(e,t,n){var i=e("papaparse")
t.exports=function(e,t){i.parse(e,{complete:function(e){t(e)}})}},{papaparse:37}],26:[function(e,t,n){function i(e,t,n){var i=e.properties[n.geo],r=!isNaN(i),o=null
return t.forEach(function(e){r?+e[n.csv]===+i&&(o=e):e[n.csv]===i&&(o=e)}),o}function r(e,t){for(k in t)e.properties[k]=t[k]
return e}n.checkParsed=function(e,t){t.errors.length>0?e.emit("parse-errors",t.errors):e.emit("parse-success",t.data)},n.csvToJson=function(e,t){var n=[]
return t.forEach(function(t){var i={}
t.forEach(function(t,n){i[e[n]]=t}),n.push(i)}),n},n.joinThem=function(e,t,n,o){var s=[]
t.forEach(function(e){var t=i(e,n,o)
s.push(r(e,t))}),e.emit("joined",{type:"FeatureCollection",features:s})}},{}],27:[function(e,t,n){var i=e("../utils/geo"),r=e("./lib/html"),o=e("./lib/ctrl"),s=e("../utils/save"),a=e("events").EventEmitter,u=e("./lib/process")
t.exports=function(e,t,n){var c=new a,f=i.getAllProperties(t.features)
r.init(e,f,function(){o.init(c)})
var l
c.on("props-to-keep",function(n){u(t.features,n,function(t){l={type:"FeatureCollection",features:t},r.done(e,function(){o.done(c)})})}),c.on("save",function(){s.json("edited.json",l),n(null)}),c.on("continue",function(){n(l)})}},{"../utils/geo":31,"../utils/save":36,"./lib/ctrl":28,"./lib/html":29,"./lib/process":30,events:1}],28:[function(e,t,n){function r(e){var t=document.getElementsByClassName("checkbox-input"),n=[],r=[]
for(i=0;i<t.length;i++)t[i].checked?n.push(t[i].id):r.push(t[i].id)
return e?n:r}n.init=function(e){document.getElementById("rm-selected").onclick=function(){var t=r(!1)
e.emit("props-to-keep",t)},document.getElementById("rm-unselected").onclick=function(){var t=r(!0)
e.emit("props-to-keep",t)}},n.done=function(e){document.getElementById("save").onclick=function(){e.emit("save")},document.getElementById("continue").onclick=function(){e.emit("continue")}}},{}],29:[function(e,t,n){n.init=function(e,t,n){var i='<p><b>Choose properties</b></p><div class="scroll-y">'
t.forEach(function(e){i=i+'<div class="checkbox-item"><input id="'+e+'" class="checkbox-input" type="checkbox"><span>'+e+"</span></div>"}),i+='</div><button id="rm-selected">Remove selected</button><button id="rm-unselected">Remove not selected</button>',document.getElementById(e).innerHTML=i,n()},n.done=function(e,t){var n='<p><b>Properties have been removed</b></p><button id="save">Save collection</button><button id="continue">Continue editing</button>'
document.getElementById(e).innerHTML=n,t()}},{}],30:[function(e,t,n){t.exports=function(e,t,n){var i=[]
e.forEach(function(e){var n={}
t.forEach(function(t){n[t]=e.properties[t]}),e.properties=n,i.push(e)}),n(i)}},{}],31:[function(e,t,n){var i=e("./lib/utils"),r=e("./lib/get-all-points")
n.getAllPoints=function(e){return"FeatureCollection"===e.type?r.fromFeatureCollection(e):"Feature"===e.type?r.fromFeature(e):i.isGeom(e)?r.fromGeometry(e):void 0}
var o=e("./lib/get-bbox")
n.getBbox=function(e){return"FeatureCollection"===e.type?o.fromFeatureCollection(e):"Feature"===e.type?o.fromFeature(e):i.isGeom(e)?o.fromGeometry(e):void 0}
var s=e("./lib/properties")
n.getAllProperties=function(e){return s.getAll(e)},n.getPropertyValues=function(e,t){return s.getValues(e,t)},n.getUniqPropertyValues=function(e,t){return s.getUniqValues(e,t)},n.numericValues=function(e,t){return s.numericValues(e,t)},n.propInfo=function(e){return s.propInfo(e.features)}},{"./lib/get-all-points":32,"./lib/get-bbox":33,"./lib/properties":34,"./lib/utils":35}],32:[function(e,t,n){function i(e){var t=e
if("Point"===t.type)return[t.coordinates]
if("LineString"===t.type||"MultiPoint"===t.type)return t.coordinates
if("Polygon"===t.type||"MultiLineString"===t.type){var n=[]
return t.coordinates.forEach(function(e){e.forEach(function(e){n.push(e)})}),n}if("MultiPolygon"===t.type){var n=[]
return t.coordinates.forEach(function(e){e.forEach(function(e){e.forEach(function(e){n.push(e)})})}),n}console.log('point-array ERROR: "'+t.type+'" is not a valid geometry type')}n.fromFeature=function(e){return i(e.geometry)},n.fromGeometry=function(e){return i(e)},n.fromFeatureCollection=function(e){var t=[]
return e.features.forEach(function(e){var n=i(e.geometry)
n.forEach(function(e){t.push(e)})}),t}},{}],33:[function(e,t,n){function i(e){var t={min:1/0,max:-(1/0)},n={min:1/0,max:-(1/0)}
return e.forEach(function(e){e[0]>t.max&&(t.max=e[0]),e[0]<t.min&&(t.min=e[0]),e[1]>n.max&&(n.max=e[1]),e[1]<n.min&&(n.min=e[1])}),[t.min,n.min,t.max,n.max]}var r=e("./get-all-points")
n.fromFeature=function(e){return i(r.fromFeature(e))},n.fromFeatureCollection=function(e){return i(r.fromFeatureCollection(e))},n.fromGeometry=function(e){return i(r.fromGeometry(e))}},{"./get-all-points":32}],34:[function(e,t,n){function i(e){var t=[]
for(k in e[0].properties)t.push(k)
return t}function r(e,t){var n=[]
return e.forEach(function(e){n.push(e.properties[t])}),n.sort(function(e,t){return e-t})}function s(e,t){var n=[]
return e.forEach(function(e){n.push(e.properties[t])}),u.uniq(n)}function a(e,t){var n=!0
return e.forEach(function(e){e.properties[t]&&isNaN(e.properties[t])&&(n=!1)}),n}var u=e("./utils")
n.getAll=function(e){return i(e)},n.getValues=function(e,t){return r(e,t)},n.getUniqValues=function(e,t){return s(e,t)},n.numericValues=function(e,t){return a(e,t)},n.propInfo=function(e){var t=[],n=geo.getAllProperties(o.feats)
return n.forEach(function(e){var n={key:e,uniqValues:s(o.feats,e),isNum:a(o.feats,e)}
n.maxValue=n.uniqValues[0],n.minValue=n.uniqValues[n.uniqValues.length-1],n.nbUniqValues=n.uniqValues.length,t.push(n)}),t}},{"./utils":35}],35:[function(e,t,n){n.isGeom=function(e){var t=!1,n=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"]
return n.forEach(function(n){e.type===n&&(t=!0)}),t},n.uniq=function(e){var t=[],n=!0
return e.forEach(function(e){isNaN(e)&&(n=!1)
var i=!1
t.forEach(function(t){e===t&&(i=!0)}),i||t.push(e)}),n&&(t=t.map(function(e){return+e})),t.sort(function(e,t){return e>t?1:-1}),t}},{}],36:[function(e,t,n){var i=i||function(e){"use strict"
if(!("undefined"==typeof e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in i,o=function(e){var t=new MouseEvent("click")
e.dispatchEvent(t)},s=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},c="application/octet-stream",f=4e4,l=function(e){var t=function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}
setTimeout(t,f)},h=function(e,t,n){t=[].concat(t)
for(var i=t.length;i--;){var r=e["on"+t[i]]
if("function"==typeof r)try{r.call(e,n||e)}catch(o){u(o)}}},p=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,u,f){f||(t=p(t))
var d,m=this,v=t.type,g=v===c,y=function(){h(m,"writestart progress write writeend".split(" "))},b=function(){if((a||g&&s)&&e.FileReader){var i=new FileReader
return i.onloadend=function(){var t=a?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;"),n=e.open(t,"_blank")
n||(e.location.href=t),t=void 0,m.readyState=m.DONE,y()},i.readAsDataURL(t),void(m.readyState=m.INIT)}if(d||(d=n().createObjectURL(t)),g)e.location.href=d
else{var r=e.open(d,"_blank")
r||(e.location.href=d)}m.readyState=m.DONE,y(),l(d)}
return m.readyState=m.INIT,r?(d=n().createObjectURL(t),void setTimeout(function(){i.href=d,i.download=u,o(i),y(),l(d),m.readyState=m.DONE})):void b()},m=d.prototype,v=function(e,t,n){return new d(e,t||e.name||"download",n)}
return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=p(e)),navigator.msSaveOrOpenBlob(e,t)}:(m.abort=function(){},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,v)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content)
"undefined"!=typeof t&&t.exports?t.exports.saveAs=i:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return i}),n.json=function(e,t){var n=new Blob([JSON.stringify(t)],{type:"application/json;charset=utf-8"})
i(n,e)},n.text=function(e,t){var n=new Blob([t],{type:"text/plain;charset=utf-8"})
i(n,e)},n.svg=function(e,t){var n=new Blob([t],{type:"image/svg+xml;charset=utf-8"})
i(n,e)},n.blob=function(e,t){i(t,e)}},{}],37:[function(e,t,n){!function(e){"use strict"
function n(t,n){if(n=n||{},n.worker&&k.WORKERS_SUPPORTED){var i=l()
return i.userStep=n.step,i.userChunk=n.chunk,i.userComplete=n.complete,i.userError=n.error,n.step=y(n.step),n.chunk=y(n.chunk),n.complete=y(n.complete),n.error=y(n.error),delete n.worker,void i.postMessage({input:t,config:n,workerId:i.id})}var r=null
return"string"==typeof t?r=n.download?new o(n):new a(n):(e.File&&t instanceof File||t instanceof Object)&&(r=new s(n)),r.stream(t)}function i(e,t){function n(){"object"==typeof t&&("string"==typeof t.delimiter&&1==t.delimiter.length&&-1==k.BAD_DELIMITERS.indexOf(t.delimiter)&&(u=t.delimiter),("boolean"==typeof t.quotes||t.quotes instanceof Array)&&(a=t.quotes),"string"==typeof t.newline&&(c=t.newline))}function i(e){if("object"!=typeof e)return[]
var t=[]
for(var n in e)t.push(n)
return t}function r(e,t){var n=""
"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t))
var i=e instanceof Array&&e.length>0,r=!(t[0]instanceof Array)
if(i){for(var s=0;s<e.length;s++)s>0&&(n+=u),n+=o(e[s],s)
t.length>0&&(n+=c)}for(var a=0;a<t.length;a++){for(var f=i?e.length:t[a].length,l=0;f>l;l++){l>0&&(n+=u)
var h=i&&r?e[l]:l
n+=o(t[a][h],l)}a<t.length-1&&(n+=c)}return n}function o(e,t){if("undefined"==typeof e||null===e)return""
e=e.toString().replace(/"/g,'""')
var n="boolean"==typeof a&&a||a instanceof Array&&a[t]||s(e,k.BAD_DELIMITERS)||e.indexOf(u)>-1||" "==e.charAt(0)||" "==e.charAt(e.length-1)
return n?'"'+e+'"':e}function s(e,t){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return!0
return!1}var a=!1,u=",",c="\r\n"
if(n(),"string"==typeof e&&(e=JSON.parse(e)),e instanceof Array){if(!e.length||e[0]instanceof Array)return r(null,e)
if("object"==typeof e[0])return r(i(e[0]),e)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e.data instanceof Array&&(e.fields||(e.fields=e.data[0]instanceof Array?e.fields:i(e.data[0])),e.data[0]instanceof Array||"object"==typeof e.data[0]||(e.data=[e.data])),r(e.fields||[],e.data||[])
throw"exception: Unable to serialize unrecognized input"}function r(t){function n(e){var t=v(e)
t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new u(t),this._handle.streamer=this,this._config=t}this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},n.call(this,t),this.parseChunk=function(t){if(this.isFirstChunk&&y(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(t)
void 0!==n&&(t=n)}this.isFirstChunk=!1
var i=this._partialLine+t
this._partialLine=""
var r=this._handle.parse(i,this._baseIndex,!this._finished)
if(!this._handle.paused()&&!this._handle.aborted()){var o=r.meta.cursor
this._finished||(this._partialLine=i.substring(o-this._baseIndex),this._baseIndex=o),r&&r.data&&(this._rowCount+=r.data.length)
var s=this._finished||this._config.preview&&this._rowCount>=this._config.preview
if(w)e.postMessage({results:r,workerId:k.WORKER_ID,finished:s})
else if(y(this._config.chunk)){if(this._config.chunk(r,this._handle),this._paused)return
r=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(r.data),this._completeResults.errors=this._completeResults.errors.concat(r.errors),this._completeResults.meta=r.meta),!s||!y(this._config.complete)||r&&r.meta.aborted||this._config.complete(this._completeResults),s||r&&r.meta.paused||this._nextChunk(),r}},this._sendError=function(t){y(this._config.error)?this._config.error(t):w&&this._config.error&&e.postMessage({workerId:k.WORKER_ID,error:t,finished:!1})}}function o(e){function t(e){var t=e.getResponseHeader("Content-Range")
return parseInt(t.substr(t.lastIndexOf("/")+1))}e=e||{},e.chunkSize||(e.chunkSize=k.RemoteChunkSize),r.call(this,e)
var n
_?this._nextChunk=function(){this._readChunk(),this._chunkLoaded()}:this._nextChunk=function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)return void this._chunkLoaded()
if(n=new XMLHttpRequest,_||(n.onload=g(this._chunkLoaded,this),n.onerror=g(this._chunkError,this)),n.open("GET",this._input,!_),this._config.chunkSize){var e=this._start+this._config.chunkSize-1
n.setRequestHeader("Range","bytes="+this._start+"-"+e),n.setRequestHeader("If-None-Match","webkit-no-cache")}try{n.send()}catch(t){this._chunkError(t.message)}_&&0==n.status?this._chunkError():this._start+=this._config.chunkSize},this._chunkLoaded=function(){if(4==n.readyState){if(n.status<200||n.status>=400)return void this._chunkError()
this._finished=!this._config.chunkSize||this._start>t(n),this.parseChunk(n.responseText)}},this._chunkError=function(e){var t=n.statusText||e
this._sendError(t)}}function s(e){e=e||{},e.chunkSize||(e.chunkSize=k.LocalChunkSize),r.call(this,e)
var t,n,i="undefined"!=typeof FileReader
this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,i?(t=new FileReader,t.onload=g(this._chunkLoaded,this),t.onerror=g(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input
if(this._config.chunkSize){var r=Math.min(this._start+this._config.chunkSize,this._input.size)
e=n.call(e,this._start,r)}var o=t.readAsText(e,this._config.encoding)
i||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function a(e){e=e||{},r.call(this,e)
var t,n
this.stream=function(e){return t=e,n=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,t=e?n.substr(0,e):n
return n=e?n.substr(e):"",this._finished=!n,this.parseChunk(t)}}}function u(e){function t(){if(w&&h&&(u("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+k.DefaultDelimiter+"'"),h=!1),e.skipEmptyLines)for(var t=0;t<w.data.length;t++)1==w.data[t].length&&""==w.data[t][0]&&w.data.splice(t--,1)
return n()&&i(),r()}function n(){return e.header&&0==_.length}function i(){if(w){for(var e=0;n()&&e<w.data.length;e++)for(var t=0;t<w.data[e].length;t++)_.push(w.data[e][t])
w.data.splice(0,1)}}function r(){if(!w||!e.header&&!e.dynamicTyping)return w
for(var t=0;t<w.data.length;t++){for(var n={},i=0;i<w.data[t].length;i++){if(e.dynamicTyping){var r=w.data[t][i]
"true"==r||"TRUE"==r?w.data[t][i]=!0:"false"==r||"FALSE"==r?w.data[t][i]=!1:w.data[t][i]=a(r)}e.header&&(i>=_.length?(n.__parsed_extra||(n.__parsed_extra=[]),n.__parsed_extra.push(w.data[t][i])):n[_[i]]=w.data[t][i])}e.header&&(w.data[t]=n,i>_.length?u("FieldMismatch","TooManyFields","Too many fields: expected "+_.length+" fields but parsed "+i,t):i<_.length&&u("FieldMismatch","TooFewFields","Too few fields: expected "+_.length+" fields but parsed "+i,t))}return e.header&&w.meta&&(w.meta.fields=_),w}function o(t){for(var n,i,r,o=[",","	","|",";",k.RECORD_SEP,k.UNIT_SEP],s=0;s<o.length;s++){var a=o[s],u=0,f=0
r=void 0
for(var l=new c({delimiter:a,preview:10}).parse(t),h=0;h<l.data.length;h++){var p=l.data[h].length
f+=p,"undefined"!=typeof r?p>1&&(u+=Math.abs(p-r),r=p):r=p}l.data.length>0&&(f/=l.data.length),("undefined"==typeof i||i>u)&&f>1.99&&(i=u,n=a)}return e.delimiter=n,{successful:!!n,bestDelimiter:n}}function s(e){e=e.substr(0,1048576)
var t=e.split("\r")
if(1==t.length)return"\n"
for(var n=0,i=0;i<t.length;i++)"\n"==t[i][0]&&n++
return n>=t.length/2?"\r\n":"\r"}function a(e){var t=p.test(e)
return t?parseFloat(e):e}function u(e,t,n,i){w.errors.push({type:e,code:t,message:n,row:i})}var f,l,h,p=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,d=this,m=0,g=!1,b=!1,_=[],w={data:[],errors:[],meta:{}}
if(y(e.step)){var E=e.step
e.step=function(i){if(w=i,n())t()
else{if(t(),0==w.data.length)return
m+=i.data.length,e.preview&&m>e.preview?l.abort():E(w,d)}}}this.parse=function(n,i,r){if(e.newline||(e.newline=s(n)),h=!1,!e.delimiter){var a=o(n)
a.successful?e.delimiter=a.bestDelimiter:(h=!0,e.delimiter=k.DefaultDelimiter),w.meta.delimiter=e.delimiter}var u=v(e)
return e.preview&&e.header&&u.preview++,f=n,l=new c(u),w=l.parse(f,i,r),t(),g?{meta:{paused:!0}}:w||{meta:{paused:!1}}},this.paused=function(){return g},this.pause=function(){g=!0,l.abort(),f=f.substr(l.getCharIndex())},this.resume=function(){g=!1,d.streamer.parseChunk(f)},this.aborted=function(){return b},this.abort=function(){b=!0,l.abort(),w.meta.aborted=!0,y(e.complete)&&e.complete(w),f=""}}function c(e){e=e||{}
var t=e.delimiter,n=e.newline,i=e.comments,r=e.step,o=e.preview,s=e.fastMode
if(("string"!=typeof t||k.BAD_DELIMITERS.indexOf(t)>-1)&&(t=","),i===t)throw"Comment character same as delimiter"
i===!0?i="#":("string"!=typeof i||k.BAD_DELIMITERS.indexOf(i)>-1)&&(i=!1),"\n"!=n&&"\r"!=n&&"\r\n"!=n&&(n="\n")
var a=0,u=!1
this.parse=function(e,c,f){function l(e){w.push(e),x=a}function h(t){return f?d():("undefined"==typeof t&&(t=e.substr(a)),S.push(t),a=v,l(S),_&&m(),d())}function p(t){a=t,l(S),S=[],O=e.indexOf(n,a)}function d(e){return{data:w,errors:E,meta:{delimiter:t,linebreak:n,aborted:u,truncated:!!e,cursor:x+(c||0)}}}function m(){r(d()),w=[],E=[]}if("string"!=typeof e)throw"Input must be a string"
var v=e.length,g=t.length,y=n.length,b=i.length,_="function"==typeof r
a=0
var w=[],E=[],S=[],x=0
if(!e)return d()
if(s||s!==!1&&-1===e.indexOf('"')){for(var k=e.split(n),C=0;C<k.length;C++){var S=k[C]
if(a+=S.length,C!==k.length-1)a+=n.length
else if(f)return d()
if(!i||S.substr(0,b)!=i){if(_){if(w=[],l(S.split(t)),m(),u)return d()}else l(S.split(t))
if(o&&C>=o)return w=w.slice(0,o),d(!0)}}return d()}for(var P=e.indexOf(t,a),O=e.indexOf(n,a);;)if('"'!=e[a])if(i&&0===S.length&&e.substr(a,b)===i){if(-1==O)return d()
a=O+y,O=e.indexOf(n,a),P=e.indexOf(t,a)}else if(-1!==P&&(O>P||-1===O))S.push(e.substring(a,P)),a=P+g,P=e.indexOf(t,a)
else{if(-1===O)break
if(S.push(e.substring(a,O)),p(O+y),_&&(m(),u))return d()
if(o&&w.length>=o)return d(!0)}else{var L=a
for(a++;;){var L=e.indexOf('"',L+1)
if(-1===L)return f||E.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:a}),h()
if(L===v-1){var I=e.substring(a,L).replace(/""/g,'"')
return h(I)}if('"'!=e[L+1]){if(e[L+1]==t){S.push(e.substring(a,L).replace(/""/g,'"')),a=L+1+g,P=e.indexOf(t,a),O=e.indexOf(n,a)
break}if(e.substr(L+1,y)===n){if(S.push(e.substring(a,L).replace(/""/g,'"')),p(L+1+y),P=e.indexOf(t,a),_&&(m(),u))return d()
if(o&&w.length>=o)return d(!0)
break}}else L++}}return h()},this.abort=function(){u=!0},this.getCharIndex=function(){return a}}function f(){var e=document.getElementsByTagName("script")
return e.length?e[e.length-1].src:""}function l(){if(!k.WORKERS_SUPPORTED)return!1
if(!E&&null===k.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.")
var t=k.SCRIPT_PATH||b
t+=(-1!==t.indexOf("?")?"&":"?")+"papaworker"
var n=new e.Worker(t)
return n.onmessage=h,n.id=x++,S[n.id]=n,n}function h(e){var t=e.data,n=S[t.workerId],i=!1
if(t.error)n.userError(t.error,t.file)
else if(t.results&&t.results.data){var r=function(){i=!0,p(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},o={abort:r,pause:d,resume:d}
if(y(n.userStep)){for(var s=0;s<t.results.data.length&&(n.userStep({data:[t.results.data[s]],errors:t.results.errors,meta:t.results.meta},o),!i);s++);delete t.results}else y(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!i&&p(t.workerId,t.results)}function p(e,t){var n=S[e]
y(n.userComplete)&&n.userComplete(t),n.terminate(),delete S[e]}function d(){throw"Not implemented."}function m(t){var n=t.data
if("undefined"==typeof k.WORKER_ID&&n&&(k.WORKER_ID=n.workerId),"string"==typeof n.input)e.postMessage({workerId:k.WORKER_ID,results:k.parse(n.input,n.config),finished:!0})
else if(e.File&&n.input instanceof File||n.input instanceof Object){var i=k.parse(n.input,n.config)
i&&e.postMessage({workerId:k.WORKER_ID,results:i,finished:!0})}}function v(e){if("object"!=typeof e)return e
var t=e instanceof Array?[]:{}
for(var n in e)t[n]=v(e[n])
return t}function g(e,t){return function(){e.apply(t,arguments)}}function y(e){return"function"==typeof e}var b,_=!e.document&&!!e.postMessage,w=_&&/(\?|&)papaworker(=|&|$)/.test(e.location.search),E=!1,S={},x=0,k={}
if(k.parse=n,k.unparse=i,k.RECORD_SEP=String.fromCharCode(30),k.UNIT_SEP=String.fromCharCode(31),k.BYTE_ORDER_MARK="\ufeff",k.BAD_DELIMITERS=["\r","\n",'"',k.BYTE_ORDER_MARK],k.WORKERS_SUPPORTED=!_&&!!e.Worker,k.SCRIPT_PATH=null,k.LocalChunkSize=10485760,k.RemoteChunkSize=5242880,k.DefaultDelimiter=",",k.Parser=c,k.ParserHandle=u,k.NetworkStreamer=o,k.FileStreamer=s,k.StringStreamer=a,"undefined"!=typeof t&&t.exports?t.exports=k:y(e.define)&&e.define.amd?define(function(){return k}):e.Papa=k,e.jQuery){var C=e.jQuery
C.fn.parse=function(t){function n(){if(0==s.length)return void(y(t.complete)&&t.complete())
var e=s[0]
if(y(t.before)){var n=t.before(e.file,e.inputElem)
if("object"==typeof n){if("abort"==n.action)return void i("AbortError",e.file,e.inputElem,n.reason)
if("skip"==n.action)return void r()
"object"==typeof n.config&&(e.instanceConfig=C.extend(e.instanceConfig,n.config))}else if("skip"==n)return void r()}var o=e.instanceConfig.complete
e.instanceConfig.complete=function(t){y(o)&&o(t,e.file,e.inputElem),r()},k.parse(e.file,e.instanceConfig)}function i(e,n,i,r){y(t.error)&&t.error({name:e},n,i,r)}function r(){s.splice(0,1),n()}var o=t.config||{},s=[]
return this.each(function(t){var n="INPUT"==C(this).prop("tagName").toUpperCase()&&"file"==C(this).attr("type").toLowerCase()&&e.FileReader
if(!n||!this.files||0==this.files.length)return!0
for(var i=0;i<this.files.length;i++)s.push({file:this.files[i],inputElem:this,instanceConfig:C.extend({},o)})}),n(),this}}w?e.onmessage=m:k.WORKERS_SUPPORTED&&(b=f(),document.body?document.addEventListener("DOMContentLoaded",function(){E=!0},!0):E=!0),o.prototype=Object.create(r.prototype),o.prototype.constructor=o,s.prototype=Object.create(r.prototype),s.prototype.constructor=s,a.prototype=Object.create(a.prototype),a.prototype.constructor=a}("undefined"!=typeof window?window:this)},{}]},{},[2])
